---
layout: default
title: Galería de imágenes y videos
---
<div class="page">
    <div class="page-title"><h3>Fotos y videos</h3></div>
    <div class="page-body">
        <div class="gallery">
            <div class="row">
                <div id="owl-preview" class="owl-carousel owl-theme">
                    {% for photo in site.data.gallery %}
                    <div class="item {{photo.name}}" style="height:auto;">
                        <a class="gallery-preview" data-tmp="{{photo.tmp}}" data-target="{{photo.src}}" data-desc="preview {{photo.src}}" href="#{{photo.name}}"><img src="{{photo.tmp}}"></a>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

var gallery = [
/*{% for photo in site.data.gallery %}*/
{"name":"{{photo.name}}","src":"{{photo.src}}"},
/*{% endfor %}*/
];

var owl = $('#owl-preview');

owl.owlCarousel({
    loop:true,
    nav:true,
    items: 1,
    margin: 10,
    autoHeight: true
}).on('changed.owl.carousel', function(event){

    var data = gallery[event.page.index];

    var extension = (/[.]/.exec(data.src)) ? /[^.]+$/.exec(data.src) : undefined;

    if(extension[0] == 'jpg' || extension[0] == 'jpeg'){

        

        var loadingAnim = $(document.createElement('div')).attr({class:'lds-dual-ring'});
        owl.append(loadingAnim);

        $.ajax({
            url: data.src,
            cache: false,
            xhr: function () {
                var xhr = new XMLHttpRequest();
                xhr.responseType = 'blob';
                return xhr;
            },
            complete: function () {
                loadingAnim.remove();
            }
        }).done(function (response) {

            var fileReader = new FileReader();
            fileReader.onloadend = function () {
                if (this.result.match(/^data:image/)) {
                    $(`.item.${data.name}`).find('img').attr({ src: data.src })
                }
            }
            fileReader.readAsDataURL(response);
        });

    }

});
</script>